{"version":3,"sources":["app.js","genealogy.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9WA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"app.js","sourcesContent":["$('.add-product').click(function(){\n    /*\n    var html = '<div class=\"form-group\"><label class=\"col-md-4 control-label\"></label><div class=\"col-md-6\">';\n    html += $('.product-dropdown').html();\n    html += '</div></div>';\n    */\n    $('.add-product').addClass('link-disabled');\n    $('.product-purchase-code').prop('readonly', true);\n    $('.product-code-search').attr('disabled', true);\n    \n    var str = $('.product-container').attr('id');\n    var arr = str.split('-');\n    var id = arr[arr.length - 1];\n    id++;\n    \n    var html = '<div class=\"form-group\">';\n    html += '<input type=\"hidden\" name=\"pcid[]\" id=\"pcid-' + id + '\" value=\"\">';\n    html += '<label class=\"col-md-4 control-label\"></label>';\n    html += '<div class=\"col-md-6 product-dropdown\">';\n    html += '<input id=\"product-code-text-' + id + '\" type=\"text\" class=\"form-control product-purchase-code\" name=\"product_code[]\" style=\"width:400px; float:left; margin-right:10px;\">';\n    html += '<button type=\"button\" class=\"btn btn-default product-code-search\" id=\"product-code-button-' + id + '\">';\n    html += '<span class=\"glyphicon glyphicon-eye-open\" aria-hidden=\"true\"></span>';\n    html += '</button>';\n    html += '<span class=\"help-block code-help-block-' + id + '\" style=\"display:none;\"></span>';\n    html += '</div>';\n    html += '</div>';\n    \n    $('.product-container').append(html);\n    $('.product-container').attr('id', 'ctr-' +id);\n});\n\n$(\"#activation-code-generator\").submit(function(e){\n    e.preventDefault();\n    \n    var data = [];\n    \n    $.each($('#activation-code-generator').serializeArray(), function(i, val){\n        data[val.name] = val.value;\n    });\n    \n    $.getJSON('/activationcode/get_activation_code', \n        {\n            activation_type_id:data['activation_type_id'],\n            howmanychar:data['howmanychar'], \n            howmanycode:data['howmanycode']\n        },\n        function(data){\n            window.location = \"/activationcode\";\n        }\n    );\n});\n\n$(\"#product-code-generator\").submit(function(e){\n    e.preventDefault();\n    \n    var data = [];\n    \n    $.each($('#product-code-generator').serializeArray(), function(i, val){\n        data[val.name] = val.value;\n    });\n    \n    $.getJSON('/productcode/get_product_code', \n        {\n            ibo_id:data['ibo_id'],\n            product_id:data['product_id'],\n            howmanychar:data['howmanychar'], \n            howmanyproducts:data['howmanyproducts'],\n        },\n        function(data){\n            //window.location = \"/productcode\";\n            \n            for(var i = 0; i < data.new_product_code.length; i++){\n                var html = '';\n                html += '<tr>';\n                html += '<td>' + data.new_product_code[i].id + '</td>';\n                html += '<td>' + data.new_product_code[i].product + '</td>';\n                html += '<td>' + data.new_product_code[i].code + '</td>';\n                html += '<td>' + data.new_product_code[i].transfered_to + '</td>';\n                html += '<td>' + data.new_product_code[i].datetime_transfered + '</td>';\n                html += '</tr>';\n\n                $('.new-product-code-table').append(html);\n            }\n            \n            $('.print-product-codes').removeClass('link-disabled');\n        }\n    );\n});\n\n$('.code-search').click(function(){\n    $.getJSON('/activationcode/check_activation_code', {code:$('#activation_code').val().toUpperCase()}, function(data){\n        if(data){\n            $('#cid').val(data.id);\n            $('#activation_code_type').val(data.activation_code_type);\n            \n            var color = 'green';\n            \n            var html = '';\n            html += 'Code Type: <strong>' + data.activation_code_type + '</strong>';\n            \n            if(data.datetime_used){\n                html += '<br/>(already used to ' + data.used_by_ibo + ' (' + data.used_by_ibo_id + ') ' + ' at ' + data.datetime_used + ')';\n                color = 'red';\n            }\n            else{\n                html += ' (not yet used)';\n                \n                $('.register-button').removeAttr('disabled');\n            }\n            \n            $('.code-help-block').css('color', color).html(html).show();\n        }\n        else $('.code-help-block').css('color', 'red').html('<strong>Code does not exist</strong>').show();\n    });\n});\n\n//$('.product-code-search').click(function(){\n$(document).on(\"click\", '.product-code-search', function(){\n    var str = $(this).attr('id');\n    var arr = str.split('-');\n    var id = arr[arr.length - 1];\n    var orig_code = $('#product-code-text-' + id).val();\n    var code_ = $('#product-code-text-' + id).val().toUpperCase();\n    var used = false;\n    \n    $.getJSON('/productcode/check_product_code', {code:code_}, function(data){\n        if(data){\n            $('#pcid-' + id).val(data.id);\n            \n            var color = 'green';\n            \n            var html = '';\n            html += 'Product name: <strong>' + data.product.name + '</strong>';\n            \n            if(data.datetime_used){\n                html += '<br/>Product Code: ' + orig_code;\n                html += '<br/>(used: ' + data.datetime_used + ')';\n                color = 'red';\n                \n                $('#product-code-text-' + id).val('');\n            }\n            else{\n                /*\n                $('input[name^=\"product_code\"]').each(function() {\n                    console.log($(this).val());\n                });\n                */\n                for(var i = 1; i < id; i++) if($('#product-code-text-' + i).val() == code_) used = true;\n\n                if(!used){\n                    html += ' (not yet used)';\n\n                    $('.register-button').removeAttr('disabled');\n                    $('.add-product').removeClass('link-disabled');\n                }\n                else{\n                    html += ' (currently used)';\n                    color = 'red';\n                }\n            }\n            \n            $('.code-help-block-' + id).css('color', color).html(html).show();\n        }\n        else{\n            $('#product-code-text-' + id).val('');\n            $('.code-help-block-' + id).css('color', 'red').html('<strong>Product Code \"' + orig_code + '\" does not exist</strong>').show();\n        }\n    });\n});\n\n$(\"#activation_code\").click(function(){\n    $(this).val('');\n    $('.code-help-block').hide();\n    $('.register-button').attr('disabled', true);\n});\n\n$('#code-tabs a').click(function(e){\n    e.preventDefault();\n    $(this).tab('show');\n})\n\n$('input[name=\"transfer_to\"]').click(function(e){\n    if($(this).val() == 'ms') $('.ms-text-box').show();\n    else $('.ms-text-box').hide();\n})\n\n$('#selectWeek').change(function(){\n    window.location = '/commissionsummaryreport/all/' + $(this).val() + '|' + $('#selectYear').val();\n});\n\n$('#selectYear').change(function(){\n    window.location = '/commissionsummaryreport/all/1|' + $(this).val();\n});\n\n$('#indirect-week').change(function(){\n    console.log('indirect commission week changed');\n    window.location = '/indirectcommission500up/' + $(this).val() + '|' + $('#indirect-year').val();\n});\n\n$('#indirect-year').change(function(){\n    console.log('indirect commission year changed');\n    window.location = '/indirectcommission500up/' + $('#indirect-week').val() + '|' + $(this).val();\n});\n\n$('#all-indirect-week').change(function(){\n    console.log('all indirect commission week changed');\n    window.location = '/allindirectcommission/' + $(this).val() + '|' + $('#all-indirect-year').val();\n});\n\n$('#all-indirect-year').change(function(){\n    console.log('all indirect commission year changed');\n    window.location = '/allindirectcommission/' + $('#all-indirect-week').val() + '|' + $(this).val();\n});\n\n$('.product-code-transfered-to, .product-code-product-id').change(function(){\n    //if($('.product-code-transfered-to').val() || $('.product-code-product-id').val()) $('.print-all-product-codes').removeClass('link-disabled');\n    //else $('.print-all-product-codes').addClass('link-disabled');\n    \n    var query_string = '?transfered_to=' + $('.product-code-transfered-to').val() + '&product_id=' + $('.product-code-product-id').val();\n    window.location = '/productcode/all' + query_string;\n});\n\n$(document).on('click', '.product-purchase-code', function(){\n    $('.register-button').attr('disabled', true);\n});\n\n$(\"#ibo_id\").click(function(){\n    $(\"#name\").val('');\n});\n\n$(\"#name\").click(function(){\n    $(\"#ibo_id\").val('');\n});\n\n$('.ibo-search-button').click(function(e){\n    e.preventDefault();\n    \n    $('.ibo-search-loading').show();\n    \n    $.getJSON('/ibo/search', {ibo_id:$('#ibo_id').val(), name:$('#name').val()}, function(data){\n        if(data){\n            var html = '<hr>';\n            \n            for(var key in data.ibo.info){\n                var info = data.ibo.info[key];\n                \n                html += '<div class=\"panel-group\" id=\"accordion\" role=\"tablist\" aria-multiselectable=\"true\">';\n                html += '    <div class=\"panel panel-default\">';\n                html += '        <div class=\"panel-heading\" role=\"tab\" id=\"headingOne\">';\n                html += '            <h4 class=\"panel-title\">';\n                html += '                    ' + info.firstname + ' ' + info.middlename + ' ' + info.lastname + ' (' + info.ibo_id + ')';\n                html += '                <a class=\"collapsed\" role=\"button\" data-toggle=\"collapse\" data-parent=\"#accordion\" href=\"#collapse' + info.id + '\" aria-expanded=\"false\" aria-controls=\"collapse' + info.id + '\">';\n                html += '                   <span class=\"pull-right\">View</span>'\n                html += '                </a>';\n                html += '            </h4>';\n                html += '        </div>';\n                html += '        <div id=\"collapse' + info.id + '\" class=\"panel-collapse collapse\" role=\"tabpanel\" aria-labelledby=\"heading' + info.id + '\">';\n                html += '            <div class=\"panel-body\">';\n                html += '               <table class=\"table\">';\n                html += '                   <tbody>';\n                html += '                       <tr><td class=\"ibo-search-table-left\">Name</td><td class=\"ibo-search-table-right\">' + info.firstname + ' ' + info.middlename + ' ' + info.lastname + '</td></tr>';\n                html += '                       <tr><td class=\"ibo-search-table-left\">Email</td><td class=\"ibo-search-table-right\">' + info.email + '</td></tr>';\n                html += '                       <tr><td class=\"ibo-search-table-left\">Gender</td><td class=\"ibo-search-table-right\">' + info.gender_id + '</td></tr>';\n                html += '                       <tr><td class=\"ibo-search-table-left\">Birthdate</td><td class=\"ibo-search-table-right\">' + info.birth_date + '</td></tr>';\n                html += '                       <tr><td class=\"ibo-search-table-left\">Marital Status</td><td class=\"ibo-search-table-right\">' + info.marital_status_id + '</td></tr>';\n                html += '                       <tr><td class=\"ibo-search-table-left\">TIN</td><td class=\"ibo-search-table-right\">' + info.tin + '</td></tr>';\n                html += '                       <tr><td class=\"ibo-search-table-left\">SSS</td><td class=\"ibo-search-table-right\">' + info.sss + '</td></tr>';\n                html += '                       <tr><td class=\"ibo-search-table-left\">Address</td><td class=\"ibo-search-table-right\">' + info.address + '</td></tr>';\n                html += '                       <tr><td class=\"ibo-search-table-left\">City</td><td class=\"ibo-search-table-right\">' + info.city + '</td></tr>';\n                html += '                       <tr><td class=\"ibo-search-table-left\">Province</td><td class=\"ibo-search-table-right\">' + info.province + '</td></tr>';\n                html += '                       <tr><td class=\"ibo-search-table-left\">Contact #</td><td class=\"ibo-search-table-right\">' + info.contact_no + '</td></tr>';\n                html += '                       <tr><td class=\"ibo-search-table-left\">Sponsor</td><td class=\"ibo-search-table-right\">' + info.sponsor_id + '</td></tr>';\n                html += '                       <tr><td class=\"ibo-search-table-left\">Placement</td><td class=\"ibo-search-table-right\">' + info.placement_id + '</td></tr>';\n                html += '                       <tr><td class=\"ibo-search-table-left\">Placement Position</td><td class=\"ibo-search-table-right\">' + info.placement_position + '</td></tr>';\n                html += '                       <tr><td class=\"ibo-search-table-left\">Activation code</td><td class=\"ibo-search-table-right\">' + info.activation_code + '</td></tr>';\n                html += '                       <tr><td class=\"ibo-search-table-left\">Pickup center</td><td class=\"ibo-search-table-right\">' + info.pickup_center_id + '</td></tr>';\n                html += '                       <tr><td class=\"ibo-search-table-left\">Bank</td><td class=\"ibo-search-table-right\">' + info.bank_id + '</td></tr>';\n                html += '                       <tr><td class=\"ibo-search-table-left\">Account #</td><td class=\"ibo-search-table-right\">' + info.account_no + '</td></tr>';\n                html += '                   </tbody>';\n                html += '               </table>';\n                html += '            </div>';\n                html += '        </div>';\n                html += '    </div>';\n                html += '</div>';\n            }\n            \n            $('.ibo-search-display').html(html);\n            \n            $('.ibo-search-loading').hide();\n        }\n    });\n});\n\n$('#rebates-week').change(function(){\n    console.log('all rebates commission week changed');\n    window.location = '/commissionsummaryreport/0?type=monthly&month=' + $(this).val() + '&year=' + $('#rebates-year').val();\n});\n\n$('#rebates-year').change(function(){\n    console.log('all rebates commission year changed');\n    window.location = '/commissionsummaryreport/0?type=monthly&month=' + $('#rebates-week').val() + '&year=' + $(this).val();\n});\n\n$('#myrebates-week').change(function(){\n    console.log('all rebates commission week changed');\n    window.location = '/commissionsummaryreport/' + $('#myrebates-ibo-id').val() + '?type=myrebate&month=' + $(this).val() + '&year=' + $('#myrebates-year').val();\n});\n\n$('#myrebates-year').change(function(){\n    console.log('all rebates commission year changed');\n    window.location = '/commissionsummaryreport/' + $('#myrebates-ibo-id').val() + '?type=myrebate&month=' + $('#myrebates-week').val() + '&year=' + $(this).val();\n});\n\n$('.change-password').click(function(e){\n    console.log('change password');\n    \n    $('.change-password-message-main, .change-password-message').html('');\n});\n\n$('#old-password, #new-password').keyup(function(e){\n    if($('#old-password').val() && $('#new-password').val()) $('.change-password-button').attr('disabled', false);\n    else $('.change-password-button').attr('disabled', true);\n});\n\n$('.change-password-button').click(function(e){\n    console.log('change password button');\n    \n    $.getJSON('/user/changepassword', {old_password:$('#old-password').val(), new_password:$('#new-password').val()}, function(data){\n        if(data){\n            console.log(data);\n            \n            if(!data.authenticated){\n                $('.change-password-message').html('<div class=\"alert alert-success fade in\"><a href=\"#\" class=\"close\" data-dismiss=\"alert\" aria-label=\"close\" title=\"close\">×</a>' + data.message + '</div>');\n            }\n            else{\n                $('.change-password-message-main').html('<div class=\"alert alert-success fade in\"><a href=\"#\" class=\"close\" data-dismiss=\"alert\" aria-label=\"close\" title=\"close\">×</a>' + data.message + '</div>');\n                $('#old-password, #new-password').val('');\n                $(this).attr('disabled', true);\n                $('#modal-change-password').modal('hide');\n            }\n        }\n    });\n});\n\n$('.close-password-button').click(function(e){\n    $('#old-password, #new-password').val('');\n    $('.change-password-button').attr('disabled', true);\n});\n\n$('.ibo-info-search').click(function(){\n    var id_ = $(this).attr('data-id');\n    var ibo_id_ = $('#' + id_).val();\n\n    $.getJSON('/ibo/search', {ibo_id:ibo_id_}, function(data){\n        var html = 'IBO not registered';\n\n        if(data) html = 'IBO Name: ' + data.ibo.info[0].firstname + ' ' + data.ibo.info[0].middlename + ' ' + data.ibo.info[0].lastname;\n\n        $('.' + id_ + '-help-block').css('color', 'green').html(html).show();\n    });\n});\n\n$('.flushout-fetch').click(function(){\n    console.log('flushout');\n    window.location = '/flushout?date=' + $('.flushout-date').val();\n});\n","var sponsor_id = 0;\n\nif(typeof $('#genealogy_sponsor_id').val() !== 'undefined') sponsor_id = $('#genealogy_sponsor_id').val();\n\n$('#chart-container').orgchart({\n    'data':'/genealogy/' + sponsor_id,\n    'nodeContent':'title',\n    'nodeId':'id'\n})\n.on('click', '.node', function(e){\n    if($(this).find('.title').text() == ''){\n        var _id = $(this).attr('id');\n        var id_arr = _id.split('|');\n                \n        if(id_arr[0]){\n            //window.location.href = '/ibo/create?placement_id=' + id_arr[0] + '&placement_position=' + id_arr[1];\n            window.open('/ibo/create?placement_id=' + id_arr[0] + '&placement_position=' + id_arr[1], '_blank');\n        }\n    }\n    else{\n        window.location.href = '/genealogy?sponsor_id=' + $(this).find('.title').text() + '&placement_id=' + $(this).attr('id');\n        //window.open('/genealogy?sponsor_id=' + $(this).find('.title').text() + '&placement_id=' + $(this).attr('id'), '_blank');\n    }\n});"]}